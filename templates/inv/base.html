{# templates/base.html #}
{% load static %}
<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>{% block title %}Intentory system{% endblock %}</title>

  <style>
    :root {
      --topbar-bg: #b2cce6;
      --topbar-height: 75px;
      --text: #1f2937;           
      --text-muted: #374151;
      --hover: rgba(0,0,0,.06);
    }
    * { box-sizing: border-box; }
    html, body { margin:0; padding:0; }
    body { font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", "Liberation Sans", sans-serif; color: var(--text); }

    .topbar {
      position: fixed;
      top: 0; left: 0; right: 0;
      height: var(--topbar-height);
      background: var(--topbar-bg);
      display: flex;
      align-items: center;
      padding: 0 16px;
      z-index: 1000;
      border-bottom: 1px solid rgba(0,0,0,.08);
    }
    .page {
        padding: 16px;
        padding-top: calc(var(--topbar-height) + 20px);
    }
    .topbar__left, .topbar__right {
      display: flex; align-items: center;
    }
    .topbar__left { gap: 20px; flex: 1 1 auto; }
    .topbar__logo img {
        max-height:65px;
        width: auto;
    }
    .topbar__project {
        font-family: "Poppins", sans-serif;
        font-weight: 600;
        font-size: 1.65rem;
        line-height: 1;
    }

    .icon-btn {
      display: inline-flex; align-items: center; justify-content: center;
      width: 33px; height: 33px; border-radius: 8px; border: none; background: transparent;
      color: var(--text); cursor: pointer;
    }
    .icon-btn:hover { background: var(--hover); }    
    .icon-btn svg {
        width: 25px;
        height: 25px;
    }

    .dropdown {
      position: relative;
    }
    .dropdown__menu {
      position: absolute; top: calc(100% + 6px); right: 0;
      min-width: 220px; background: #fff; border: 1px solid rgba(0,0,0,.1);
      border-radius: 8px; box-shadow: 0 8px 20px rgba(0,0,0,.12);
      padding: 6px; display: none; z-index: 1100;
    }
    .dropdown__item svg {
        width: 25px;
        height: 25px;
    }
    .dropdown__item {
      display: flex; align-items: center; gap: 10px;
      padding: 8px 12px; color: var(--text); text-decoration: none; border-radius: 6px;
    }
    .dropdown__item:hover { background: var(--hover); }
    .dropdown--open .dropdown__menu { display: block; }

    .page {
      padding: 16px;
      padding-top: calc(var(--topbar-height) + 16px);
    }

    .icon-btn:focus-visible, .dropdown__item:focus-visible, a:focus-visible {
      outline: 3px solid #2563eb55; outline-offset: 2px;
    }

    @media (max-width: 560px) {
      .topbar__project { font-size: 14px; }
    }
  </style>

  {% block extra_head %}{% endblock %}
</head>
<body>
  <header class="topbar" role="banner">
    <div class="topbar__left">
      <!-- LOGO -->
      <div class="topbar__logo">
        <img src="{% static 'img/aptiv_logo_color_rgb.png' %}"
             alt="Company Logo"
             style="height: 32px; width: auto;">
    </div>
      <div class="topbar__project">Intentory system</div>
    </div>

    <div class="topbar__right">
{% comment %}       <!-- Help  -->
      <button class="icon-btn" title="Ayuda" aria-label="Ayuda" onclick="window.location.href='{% url 'inv:home_view' %}#help'">
        <!-- Ã­cono simple de ? -->
        <svg xmlns="http://www.w3.org/2000/svg" width="19" height="19" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.75" stroke-linecap="round" stroke-linejoin="round">
          <path d="M9 9a3 3 0 0 1 6 0c0 1.5-1 2-2 2s-1 1-1 2"/><line x1="12" y1="17" x2="12" y2="17"/>
          <circle cx="12" cy="12" r="10"></circle>
        </svg>
      </button> {% endcomment %}

      <!-- SETTINGS -->
      <div class="dropdown" id="settingsDropdown">
        <button class="icon-btn" aria-haspopup="menu" aria-expanded="false" aria-controls="settings-menu" title="Settings" onclick="toggleSettings()">
          <!-- Engrane -->
            <svg class="icon--topbar" viewBox="0 0 24 24" fill="none"
                stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round">
                <circle cx="12" cy="12" r="3"></circle>
                <path d="M19.4 15a1.65 1.65 0 0 0 .3 1.9l.1.1a2 2 0 1 1-2.8 2.8l-.1-.1a1.65 1.65 0 0 0-1.9-.3 1.65 1.65 0 0 0-1 1.5V22a2 2 0 0 1-4 0v-.1a1.65 1.65 0 0 0-1-1.5 1.65 1.65 0 0 0-1.9.3l-.1.1A2 2 0 1 1 4.2 17l.1-.1a1.65 1.65 0 0 0 .3-1.9 1.65 1.65 0 0 0-1.5-1H2a2 2 0 0 1 0-4h.1a1.65 1.65 0 0 0 1.5-1 1.65 1.65 0 0 0-.3-1.9l-.1-.1A2 2 0 1 1 5.2 4.2l.1.1a1.65 1.65 0 0 0 1.9.3A1.65 1.65 0 0 0 8.6 3V3a2 2 0 0 1 4 0v.1c0 .7.4 1.3 1 1.5.6.3 1.3.1 1.9-.3l.1-.1A2 2 0 1 1 20.7 7l-.1.1c-.5.5-.6 1.2-.3 1.9.2.6.8 1 1.5 1H22a2 2 0 0 1 0 4h-.1c-.7 0-1.3.4-1.5 1Z"/>
            </svg>
        </button>

        <div class="dropdown__menu" id="settings-menu" role="menu" aria-label="Settings menu">
          <a class="dropdown__item" href="{% url 'inv:user_manage' %}">
            <!-- users -->
            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="none" stroke="currentColor" stroke-width="1.75" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
              <path d="M17 21v-2a4 4 0 0 0-3-3.87M7 21v-2a4 4 0 0 1 3-3.87"/>
              <circle cx="9" cy="7" r="3"></circle>
              <path d="M22 21v-2a4 4 0 0 0-3-3.87"/><circle cx="17" cy="7" r="3"></circle>
            </svg>
            <span>User Management</span>
          </a>
          <a class="dropdown__item" href="{% url 'inv:user_profile' %}">
            <!-- profile -->
            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="none" stroke="currentColor" stroke-width="1.75" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
              <path d="M20 21a8 8 0 1 0-16 0"/>
              <circle cx="12" cy="7" r="4"></circle>
            </svg>
            <span>Perfil</span>
          </a>
        </div>
      </div>

      <!-- Logout -->
      <form action="{% url 'inv:logout' %}" method="post" style="margin-left: 6px;">
        {% csrf_token %}
        <button class="icon-btn" title="Logout" aria-label="Logout">
          <svg xmlns="http://www.w3.org/2000/svg" width="19" height="19" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.75" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
            <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/>
            <polyline points="16 17 21 12 16 7"/>
            <line x1="21" y1="12" x2="9" y2="12"/>
          </svg>
        </button>
      </form>
    </div>
  </header>

  <main class="page" role="main">
    {% block content %}{% endblock %}
  </main>

  <script>
    function toggleSettings() {
      const dd = document.getElementById('settingsDropdown');
      const btn = dd.querySelector('button[aria-haspopup="menu"]');
      dd.classList.toggle('dropdown--open');
      const open = dd.classList.contains('dropdown--open');
      btn.setAttribute('aria-expanded', open ? 'true' : 'false');
    }
    document.addEventListener('click', (e) => {
      const dd = document.getElementById('settingsDropdown');
      if (!dd) return;
      if (!dd.contains(e.target)) {
        dd.classList.remove('dropdown--open');
        const btn = dd.querySelector('button[aria-haspopup="menu"]');
        if (btn) btn.setAttribute('aria-expanded','false');
      }
    });
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape') {
        const dd = document.getElementById('settingsDropdown');
        if (dd) dd.classList.remove('dropdown--open');
      }
    });
  </script>

  {% block extra_body %}{% endblock %}
</body>
</html>